<form action="/graph" method="get">
  <input title="Window width"
         name="window_width"
         type="text"
         value="<%= window_width %>"/>
  <input title="Give up after"
         name="give_up_after"
         type="text"
         value="<%= give_up_after %>"/>
  <input title="OHLC"
         name="ohlc_select"
         type="checkbox"
         <%= ohlc.nil? ? '' : 'checked' %>>
  <input title="Seperate"
         name="others_select"
         type="checkbox"
         <%= seperate_lines ? 'checked' : '' %>>
  <input type="submit" value="Submit" />
</form>

<div id="container" style="height: 900px; min-width: 600px">
  Loading...
</div>

<script>
$(function () {
  $('#container').highcharts('StockChart', {

    rangeSelector : {
      selected : 4
    },

    title : {
      text : 'Test Stock Chart'
    },

    xAxis: {
      type: 'datetime',
      // tickInterval: 3600 * 1000,
    },

    series : [
    <% if seperate_lines %>
    {
      name : 'high',
      data : <%= high.to_json %>,
      id : 'dataseries'
    }, {
      name : 'open',
      data : <%= open.to_json %>
    }, {
      name : 'close',
      data : <%= close.to_json %>
    }, {
      name : 'low',
      data : <%= low.to_json %>
    },
    <% end %>
    {
      name : '20 Day',
      data : <%= avg20d.to_json %>
    }, {
      name : '50 Day',
      data: <%= avg50d.to_json %>
    }, {
      name : 'OHLC',
      type : 'ohlc',
      data  :<%= ohlc.to_json %>
    }, {
      type : 'flags',
      data : <%= collections.to_json %>,
      onSeries : 'dataseries',
      shape : 'squarepin',
    }]
  });
});
</script>
